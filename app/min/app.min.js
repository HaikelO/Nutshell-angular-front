function LoginController(a,b,c,d,e,f,g){a.login=function(b){if(void 0!==b){var c=a.log.name,d=a.log.password;console.log(c),void 0!==b.password&&void 0!==b.name&&g.Login(c,d,function(a){if(a===!0)return e.path("/Produits")})}}}function LoginService(a){return a("",{},{up:{method:"POST",url:"/api/Login","Content-Type":"application/x-www-form-urlencoded"}})}function AuthenticationService(a,b){function c(c,d,e){console.log(c,d),a({url:"/api/Login",method:"POST",data:{name:c,password:d},"Content-Type":"application/x-www-form-urlencoded"}).then(function(d){if(console.log("success"),console.log(d),d.token){var f=angular.toJson(d.token);return console.log(f),b.currentUser={username:c,token:d.token},console.log(b.currentUser.token),a.defaults.headers.Authorization=f.token,e(!0)}e(!1)})}function d(){delete b.currentUser,a.defaults.headers.common.Authorization=""}return{Login:c,Logout:d}}function ClientController(a,b,c,d,e){this.Client=e.query({clientId:c.clientId})}function ClientService(a,b){return a("",{clientId:"@id"},{query:{method:"GET",url:"/api/Client/:clientId"},save:{method:"POST",url:"/api/Client","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Client/:clientId"}})}function ClientsController(a,b,c,d,e){var f=this;f.Clients=e.query(),f.aClient=function(a){var b=angular.toJson(a);f.Client=d.save(b,function(){f.Clients=e.query(),f.ajoutC={}})},f.aChampContact=function(){var a={adresse:null,name:null,phone:null,mail:null};f.ajoutC.contact.push(a)},f.sClient=function(a){f.Client=d.delete({clientId:a._id},function(){f.Clients=e.query()})}}function ClientsService(a,b){return a("",{},{query:{method:"GET",url:"/api/Clients",isArray:!0}})}function ConfigurationController(a,b,c){}function PersonnelController(a,b,c,d,e){a.Personnel=d.query(),a.aPersonnel=function(b){var c=angular.toJson(b);a.Employe=e.save(c,function(){a.Personnel=d.query(),a.ajoutP={}})},a.sPersonnel=function(b){a.Employe=e.EmployeService({employeId:b._id},function(){a.Personnel=d.query()})}}function EmployeController(a,b,c,d,e){a.Employe=e.query({employeId:c.employeId})}function PersonnelService(a,b){return a("",{},{query:{method:"GET",url:"/api/Personnel",isArray:!0}})}function EmployeService(a,b){return a("",{employeId:"@id"},{query:{method:"GET",url:"/api/Employe/:employeId"},save:{method:"POST",url:"/api/Employe","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Employe/:employeId"}})}function EtatsService(){return{get:function(){return this.etatTableau=[{id:"1",name:"Devis"},{id:"2",name:"En cours de traitement"},{id:"3",name:"Termin√©"}],this.etatTableau}}}function MachineryService(a,b){return a("",{},{query:{method:"GET",url:"/api/Machinery",isArray:!0}})}function MachineController(a,b,c,d,e){a.Machine=e.query({machineId:c.machineId})}function MachineService(a,b){return a("/Machine/:machineId",{MachineryId:"@id"},{query:{method:"GET",url:"/api/Machine/:machineId"},save:{method:"POST",url:"/api/Machine","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Machine/:machineId"}})}function MachineryController(a,b,c,d,e){var f=this;f.Machinery=d.query(),f.aMachine=function(a){var b=angular.toJson(a);f.Machine=Machine.save(b,function(){f.Machinery=d.query(),f.ajoutM={}})},f.sMachine=function(a){var c={"Content-Type":"application/x-www-form-urlencoded"};b.delete("http://127.0.0.1:8080/api/Machine/"+a._id,c).success(function(a){f.Machinery=d.query()})}}function MouleController(a,b,c,d,e,f){a.Moule=Moule.query({mouleId:c.mouleId}),a.Machinery=f.query(),a.modifiermoule={},a.modifiermoule.Machinery=[],a.smMoule=function(b){b.id&&(a.modifiermoule.id=b.id),b.name&&(a.modifiermoule.name=b.name),b.type&&(a.modifiermoule.type=b.type),b.empreinte&&(a.modifiermoule.empreinte=b.empreinte),b.nombre_utilisation&&(a.modifiermoule.nombre_utilisation=b.nombre_utilisation),b.poid&&(a.modifiermoule.poid=b.poid),b.etat&&(a.modifiermoule.etat=b.etat),b.description&&(a.modifiermoule.description=b.description),b.fabricant&&(a.modifiermoule.fabricant=b.fabricant),b.Machinery&&(a.modifiermoule.Machinery=b.Machinery),b._id&&(a.modifiermoule._id=b._id),console.debug("modifier")},a.acMachine=function(){var b={id:null,name:null};a.modifiermoule.Machinery.push(b),console.debug("Ajout Champ Machine")},a.rcMachine=function(){a.modifiermoule.Machinery=[]},a.mMoule=function(b){var d=JSON.stringify(b);a.Moule=e.save(d,function(){a.Moule=e.query({mouleId:c.mouleId}),a.modifiermoule={}})}}function MouleService(a,b){return a("",{mouleId:"@id"},{query:{method:"GET",url:"/api/Moule/:mouleId"},save:{method:"POST",url:"/api/Moule","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Moule/:mouleId"}})}function MoulesController(a,b,c,d,e,f){var g=this;g.Moules=d.query(),g.Machinery=f.query(),g.ajoutMoule={},g.ajoutMoule.Machinery=[],g.aMoule=function(a){var b=angular.toJson(a);g.Moule=e.save(b,function(){g.Moules=d.query(),g.ajoutMoule={}})},g.sMoule=function(a){var c={"Content-Type":"application/x-www-form-urlencoded"};b.delete("http://127.0.0.1:8080/api/Moule/"+a._id,c).success(function(a){g.Moules=d.query()})},g.acMachine=function(){var a={id:null};g.ajoutMoule.Machinery.push(a),console.debug("Ajout Champ Machine")},g.rcMachine=function(){g.ajoutMoule.Machinery=[]}}function MoulesService(a,b){return a("",{},{query:{method:"GET",url:"/api/Moules",isArray:!0}})}function EntrepotController(a,b,c,d,e){var f=this;f.Stock=[{name:"PVC",QTT:7},{name:"PVC2",QTT:5}],f.Matieres=d.query(),f.Produits=e.query()}function ProduitsService(a,b){return a("",{},{query:{method:"GET",url:"/api/products",isArray:!0}})}function MatiereController(a,b,c,d,e){vm=this,vm.Matiere=d.query({matiereId:c.matiereId}),vm.Fournisseurs=e.query(),vm.modifiermatiere={},vm.modifiermatiere.fournisseurs=[],vm.smMatiere=function(a){vm.modifiermatiere.id=a.id,vm.modifiermatiere.name=a.name,vm.modifiermatiere.qtt=a.qtt,vm.modifiermatiere.fournisseurs=a.fournisseurs,vm.modifiermatiere._id=a._id,console.debug("modifier")},vm.mMatiere=function(a){var e=a;e=JSON.stringify(e);var f={"Content-Type":"application/x-www-form-urlencoded"};b.post("http://127.0.0.1:8080/api/Matiere",e,f).success(function(a){vm.modifiermatiere={},vm.Matiere=d.query({matiereId:c.matiereId})}),console.debug("Sauvegarder")},vm.acFournisseur=function(){var a={id:null};vm.modifiermatiere.fournisseurs.push(a),console.debug("Ajout Champ Fournisseur")},vm.rcFournisseur=function(){vm.modifiermatiere.fournisseurs=[]}}function MatiereService(a,b){return a("/Matiere/:matiereId",{matiereId:"@id"},{query:{method:"GET",url:"/api/Matiere/:matiereId?"},save:{method:"POST",url:"/api/Matiere","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Matiere/:matiereId"}})}function MatieresController(a,b,c,d,e,f){vm=this,vm.ajoutMatiere={},vm.ajoutMatiere.fournisseurs=[],vm.Fournisseurs=f.query(),vm.aMatiere=function(a){var b=angular.toJson(a);console.debug("Ajouter"),vm.Matiere=e.save(b,function(){vm.Matieres=d.query(),vm.ajoutF={}})},vm.amMatiere=function(){console.debug("Annuler"),vm.modifiermatiere={}},vm.smMatiere=function(a){a.id&&(vm.modifiermatiere.id=a.id),a.name&&(vm.modifiermatiere.name=a.name),a.qtt&&(vm.modifiermatiere.qtt=a.qtt),a.fournisseurs&&(vm.modifiermatiere.fournisseurs=a.fournisseurs),a._id&&(vm.modifiermatiere._id=a._id),console.debug("modifier")},vm.mMatiere=function(a){var c=a;c=JSON.stringify(c);var e={"Content-Type":"application/x-www-form-urlencoded"};b.post("http://127.0.0.1:8080/api/Matiere",c,e).success(function(a){vm.Matieres=d.query(),vm.ajoutMatiere={},vm.modifiermatiere={}}),console.debug("Sauvegarder")},vm.sMatiere=function(a){vm.Matiere=e.delete({matiereId:a._id},function(){vm.Matieres=d.query()})},vm.acFournisseur=function(){var a={id:null};vm.ajoutMatiere.fournisseurs.push(a),console.debug("Ajout Champ Fournisseur")},vm.rcFrounisseur=function(){vm.ajoutMatiere.fournisseurs=[]},vm.Matieres=d.query()}function MatieresService(a,b){return a("",{},{query:{method:"GET",url:"/api/Matieres",isArray:!0}})}function ProduitController(a,b,c,d,e,f){function g(){vm.Produit.$promise.then(function(a){angular.forEach(a.nomenclature.produits,function(a,b){vm.Produits.$promise.then(function(b){console.log(b),angular.forEach(b,function(b,c){if(b.id===a.id)return a.name=b.name,vm.Produit2.push(a),this})})}),angular.forEach(vm.Produit.nomenclature.matieres,function(a,b){vm.Matieres.$promise.then(function(b){angular.forEach(b,function(b,c){if(b.id===a.id)return a.name=b.name,this})})})})}vm=this,vm.Produit2=[],vm.modifierproduit={},vm.modifierproduit.nomenclature={},vm.modifierproduit.stock=[],vm.modifierproduit.nomenclature.produits=[],vm.modifierproduit.nomenclature.matieres=[],vm.Produit={},vm.Produit.nomenclature={},vm.Produit.nomenclature.produits=[],vm.Produit.nomenclature.matieres=[],vm.Produit=d.query({produitId:c.produitId}),vm.Produits=e.query(),vm.Matieres=f.query(),vm.amProduit=function(){console.debug("Annuler"),vm.modifierproduit={}},vm.mProduit=function(a){var b=JSON.stringify(a);vm.Produit=d.save(b,function(){vm.Produit=d.query({produitId:c.produitId}),vm.modifierproduit={}})},vm.smProduit=function(a){vm.modifierproduit._id=a._id,vm.modifierproduit.id=a.id,vm.modifierproduit.name=a.name,vm.modifierproduit.qtt=a.qtt,vm.modifierproduit.nomenclature.produits=a.nomenclature.produits,vm.modifierproduit.nomenclature.matieres=a.nomenclature.matieres,vm.modifierproduit.stock=a.stock,console.debug("modifier")},vm.acProduit=function(){var a={id:null,qtt:null};vm.modifierproduit.nomenclature.produits.push(a),console.debug("Ajout Champ Produit")},vm.rcProduit=function(){vm.modifierproduit.nomenclature.produits=[]},vm.acStock=function(){var a={location:null,qtt:null};vm.modifierproduit.stock.push(a),console.debug("Ajout Champ Produit")},vm.rcStock=function(){vm.modifierproduit.nomenclature.stock=[]},vm.acMatiere=function(){var a={id:null,qtt:null};vm.modifierproduit.nomenclature.matieres.push(a),console.debug("Ajout Champ Matiere")},vm.rcMatiere=function(){vm.modifierproduit.nomenclature.matieres=[]},g()}function ProduitService(a,b){return a("",{produitId:"@id"},{query:{method:"GET",url:"/api/Produit/:produitId"},save:{method:"POST",url:"/api/Produit","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Produit/:produitId"}})}function ProduitsController(a,b,c,d,e,f){vm=this,vm.modifierproduit={},vm.ajoutproduit={},vm.ajoutproduit.nomenclature={},vm.ajoutproduit.nomenclature.produits=[],vm.ajoutproduit.nomenclature.matieres=[],vm.Produits=d.query(),vm.Matieres=f.query(),vm.acProduit=function(){var a={id:null,qtt:null};vm.ajoutproduit.nomenclature.produits.push(a),console.debug("Ajout Champ Produit")},vm.rcProduit=function(){vm.ajoutproduit.nomenclature.produits=[]},vm.acMatiere=function(){var a={id:null,qtt:null};vm.ajoutproduit.nomenclature.matieres.push(a),console.debug("Ajout Champ Matiere")},vm.rcMatiere=function(){vm.ajoutproduit.nomenclature.matieres=[]},vm.aProduit=function(a){var b=angular.toJson(vm.ajoutproduit);vm.Produit=e.save(b,function(){vm.Produits=d.query(),vm.ajoutproduit={}})},vm.amProduit=function(){console.debug("Annuler"),vm.modifierproduit={}},vm.smProduit=function(a){a.id&&(vm.modifierproduit.id=a.id),a.name&&(vm.modifierproduit.name=a.name),a.qtt&&(vm.modifierproduit.qtt=a.qtt),a._id&&(vm.modifierproduit._id=a._id),a.nomenclature.produits&&(vm.modifierproduit.nomenclature.produits=a.nomenclature.produits),a.nomenclature.matieres&&(vm.modifierproduit.nomenclature.matieres=a.nomenclature.matieres),a.stock&&(vm.modifierproduit.stock=a.stock),console.debug("modifier")},vm.mProduit=function(a){var b=JSON.stringify(a);vm.Produit=e.save(b,function(){vm.Produits=d.query(),vm.ajoutproduit={},vm.modifierproduit={}})},vm.sProduit=function(a){vm.Produit=e.delete({produitId:a._id},function(){vm.Produits=d.query()})}}function AchatsService(a,b){return a("",{},{query:{method:"GET",url:"/api/Achats",isArray:!0}})}function FournisseurController(a,b,c,d,e){a.Fournisseur=e.query({fournisseurId:c.fournisseurId})}function FournisseurService(a,b){return a("",{fournisseurId:"@id"},{query:{method:"GET",url:"/api/Fournisseur/:fournisseurId",isArray:!0},save:{method:"POST",url:"/api/Fournisseur","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Fournisseur/:fournisseurId"}})}function FournisseursController(a,b,c,d,e){a.Fournisseurs=d.query(),a.aFournisseur=function(b){var c=angular.toJson(b);a.Fournisseur=Fournisseur.save(c,function(){a.Fournisseurs=d.query(),a.ajoutF={}})},a.aChampContact=function(){var b={adresse:null,name:null,phone:null,mail:null};a.ajoutF.contact.push(b)},a.sFournisseur=function(b){a.Fournisseur=e.delete({fournisseurId:b._id},function(){a.Fournisseurs=d.query()})}}function FournisseursService(a,b){return a("",{},{query:{method:"GET",url:"/api/Fournisseurs",isArray:!0}})}function AchatController(a,b,c,d,e){ACtrl=this,a.Achat=e.query({achatId:d.achatId}),console.log(a.Achat),a.supprimerAchat=function(b){a.Achat=Achat.delete({achatId:b._id})}}function AchatService(a,b){return a("",{achatId:"@id"},{query:{method:"GET",url:"/api/Achat/:achatId"},save:{method:"POST",url:"/api/Achat","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Achat/:achatId"}})}function AchatsController(a,b,c,d,e,f,g,h,i){var j=this;j.Achats=d.query(),j.Fournisseurs=f.query(),j.Produits=g.query(),j.Matieres=h.query(),j.Etats=i.get(),j.aAchat=function(a){var b=angular.toJson(a);j.Achat=e.save(b,function(){j.Achats=d.query(),j.ajoutA={}})}}function FactureController(a,b){var c=this;b.getFacture(a.id).then(function(a){c.facture=a}),c.generatePDF=function(){var a=new jsPDF("p","pt","a4");a.addHTML($("#facturePDF"),15,15,{background:"#fff",width:1800,height:1800},function(){a.autoPrint(),window.open(a.output("datauristring"))})},c.generatePDF2=function(){var a=new jsPDF("a4"),b={"#editor":function(a,b){return!0}};a.fromHTML($("#facturePDF").html(),15,15,{elementHandlers:b},function(){a.autoPrint(),window.open(a.output("datauristring"))})}}function FacturemodalController(a,b,c,d,e,f,g){function h(a){console.log(a)}function i(){var a=[];return e.getClients().then(function(b){for(index=0;index<b.length;++index)a.push({value:b[index].nom.toLowerCase(),display:b[index].nom,ref:b[index].id,tel:b[index].tel,mail:b[index].mail,adresse:b[index].adresse,cp:b[index].cp,pays:b[index].pays})}),a}function j(){var a=[];return f.getProduits().then(function(b){for(index=0;index<b.length;++index)b[index].prix&&b[index].garantie&&b[index].processeur&&b[index].ram&&b[index].stockage?a.push({value:b[index].ref.toLowerCase(),display:b[index].ref,ref:b[index].ref,denomination:b[index].denomination+" "+b[index].processeur.valeur+"-"+b[index].ram.taille+"Go-"+b[index].stockage.taille+"Go",prix:{vente:b[index].prix.vente},garantie:{duree:b[index].garantie.duree}}):b[index].prix&&b[index].garantie?a.push({value:b[index].ref.toLowerCase(),display:b[index].ref,ref:b[index].ref,denomination:b[index].denomination,prix:{vente:b[index].prix.vente},garantie:{duree:b[index].garantie.duree}}):b[index].prix?a.push({value:b[index].ref.toLowerCase(),display:b[index].ref,ref:b[index].ref,denomination:b[index].denomination,prix:{vente:b[index].prix.vente}}):a.push({value:b[index].ref.toLowerCase(),display:b[index].ref,ref:b[index].ref,denomination:b[index].denomination})}),a}function k(a,b){var c=a?vm.C.queryResults.filter(d.createFilterFor(a)):vm.C.queryResults;return c}function l(a,b){var c=a?vm.P.queryResults.filter(d.createFilterFor(a)):vm.P.queryResults;return c}function m(a,b){var c=a?vm.P.queryResults.filter(d.createFilterForDisplay(a)):vm.P.queryResults;return c}function n(){for(vm.F.prix.ttc=0,vm.F.prix.ht=0,index=0;index<vm.Produits.length;++index)vm.F.prix.ttc=vm.F.prix.ttc+vm.Produits[index].tttc,vm.F.prix.ht=vm.F.prix.ttc/1.2}vm=this,vm.Produits=[],vm.simulateQuery=!1,vm.isDisabled=!1,vm.thtp="20%",vm.F={},vm.F.client={},vm.F.prix={},vm.F.produits=[],vm.F.prix.ht=0,vm.C={},vm.C.client={},vm.C.queryResults=[],vm.C.queryResults=i()||[],vm.querySearch=k,vm.querySearchproduits=l,vm.querySearchproduitsD=m,vm.P={},vm.P.queryResults=[],vm.P.queryResults=j()||[],vm.selectedCItemChange=h(),vm.selectedItemChange=d.selectedItemChange(),vm.searchTextChange=d.searchTextChange(),vm.newState=d.newState(),vm.F.Produits=[],vm.paiement=[{value:"cb",display:"CB"},{value:"cheque",display:"Ch√®que"},{value:"especes",display:"Esp√®ces"}],vm.ajouterChamp=function(){vm.Produits.push({})},vm.delChamp=function(a){vm.Produits.splice(a,1),n()},vm.cancel=function(){c.dismiss("cancel")},vm.totalFacture=function(a){if(a.selectedItem&&a.selectedItem.prix&&a.quantite)return a.tttc=a.selectedItem.prix.vente*a.quantite,a.ht=a.selectedItem.prix.vente/1.2,a.ht=a.ht.toFixed(2),n(),a},vm.ok=function(b){for(vm.FL={},vm.FL.produits=[],vm.FL.paiement={},vm.FL.prix={},vm.FL.client={},vm.FL.date=b.date,vm.FL.vendeur="Admin",vm.FL.paiement.moyen=b.paiement.moyen,vm.FL.prix.ht=vm.F.prix.ht,vm.FL.prix.ttc=vm.F.prix.ttc,vm.FL.client=vm.C.selectedItem,vm.FL.client.id=vm.C.selectedItem.ref,vm.FL.client.nom=vm.C.selectedItem.display,index=0;index<vm.Produits.length;++index)vm.FL.produits.push({ref:vm.Produits[index].selectedItem.ref,garantie:{duree:vm.Produits[index].selectedItem.garantie.duree},denomination:vm.Produits[index].selectedItem.denomination,quantite:vm.Produits[index].quantite,prix:{ttc:vm.Produits[index].selectedItem.prix.vente,ht:vm.Produits[index].selectedItem.prix.vente/1.2,tttc:vm.Produits[index].quantite*vm.Produits[index].selectedItem.prix.vente}});g.setFacture(vm.FL).then(function(b){c.close(),a.path("/Facture/"+b._id)})},vm.newClient=function(){b.open({animation:vm.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"/cl/_modules/client/index.modal.view.client.html",controller:"ClientmodalController",controllerAs:"cCtrl"}).result.then(function(a){vm.C.queryResults=i()||[]})}}function FacturationController(a,b,c){vm=this,vm.status="facture",c.getFactureList().then(function(a){vm.List=a}),vm.animationsEnabled=!1,vm.checkstatus=function(a){"facture"===a?c.getFactureList().then(function(a){vm.List=a}):c.getDevisList().then(function(a){vm.List=a})},vm.openFactureModal=function(){b.open({animation:vm.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"/cl/_modules/facturation/facture/modal/view.html",controller:"FacturemodalController",controllerAs:"vm"}).result.then(function(a){})},vm.openDevisModal=function(){b.open({animation:vm.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"/cl/_modules/facturation/devis/modal/view.html",controller:"DevismodalController",controllerAs:"vm"}).result.then(function(a){})},vm.devislist=function(){c.getDevisList().then(function(a){console.log(a),vm.List=a})},vm.rechercheList=function(a){c.getJourFactureList(a).then(function(a){vm.List=a})},vm.rechercheList2=function(a){c.getJourFactureList2(a).then(function(a){vm.List=a})},vm.factureAujourdhui=function(){c.getFactureList().then(function(a){vm.List=a})},vm.factureMois=function(){c.getMoisFactureList().then(function(a){vm.List=a})},vm.factureAnnee=function(){c.getAnneeFactureList().then(function(a){vm.List=a})},vm.afficherFacture=function(b){a.path("/Facture/"+b._id)},vm.devisAujourdhui=function(){c.getDevisList().then(function(a){vm.List=a})},vm.devisMois=function(){c.getMoisDevisList().then(function(a){vm.List=a})},vm.devisAnnee=function(){c.getAnneeDevisList().then(function(a){vm.List=a})},vm.afficherDevis=function(b){a.path("/Devis/"+b._id)}}function VentesController(a,b,c,d,e,f,g){a.Clients=f.query(),a.Ventes=e.query(),a.Produits=g.query(),a.aVente={},a.aVente.produits=[],console.log("VentesCtrl"),a.acProduit=function(){var b={id:null,qtt:null,prix:null};a.aVente.produits.push(b)},a.ajoutVente=function(b){var c=angular.toJson(a.aVente);a.Vente=d.save(c,function(){a.aVente={},a.Ventes=e.query()})}}function VentesService(a,b){return a("",{},{query:{method:"GET",url:"/api/Ventes",isArray:!0}})}function DevisController(a,b){var c=this;c.devis={},b.getDevis(a.id).then(function(a){console.log("Devis:",a),c.devis=a}),c.generatePDF=function(){var a=new jsPDF("p","pt","a4");a.addHTML($("#devisPDF"),15,15,{background:"#fff",width:1800,height:1800},function(){a.autoPrint(),window.open(a.output("datauristring"))})},c.generatePDF2=function(){var a=new jsPDF("a4"),b={"#editor":function(a,b){return!0}};a.fromHTML($("#devisPDF").html(),15,15,{elementHandlers:b},function(){a.autoPrint(),window.open(a.output("datauristring"))})}}function DevismodalController(a,b,c,d,e,f,g){function h(a){console.log(a)}function i(){var a=[];return e.getClients().then(function(b){for(index=0;index<b.length;++index)a.push({value:b[index].nom.toLowerCase(),display:b[index].nom,ref:b[index].id,tel:b[index].tel,mail:b[index].mail,adresse:b[index].adresse,cp:b[index].cp,pays:b[index].pays})}),a}function j(){var a=[];return f.getProduits().then(function(b){for(index=0;index<b.length;++index)b[index].prix&&b[index].garantie&&b[index].processeur&&b[index].ram&&b[index].stockage?a.push({value:b[index].ref.toLowerCase(),display:b[index].ref,ref:b[index].ref,denomination:b[index].denomination+" "+b[index].processeur.valeur+"-"+b[index].ram.taille+"Go-"+b[index].stockage.taille+"Go",prix:{vente:b[index].prix.vente},garantie:{duree:b[index].garantie.duree}}):b[index].prix&&b[index].garantie?a.push({value:b[index].ref.toLowerCase(),display:b[index].ref,ref:b[index].ref,denomination:b[index].denomination,prix:{vente:b[index].prix.vente},garantie:{duree:b[index].garantie.duree}}):b[index].prix?a.push({value:b[index].ref.toLowerCase(),display:b[index].ref,ref:b[index].ref,denomination:b[index].denomination,prix:{vente:b[index].prix.vente}}):a.push({value:b[index].ref.toLowerCase(),display:b[index].ref,ref:b[index].ref,denomination:b[index].denomination})}),a}function k(a,b){var c=a?vm.C.queryResults.filter(d.createFilterFor(a)):vm.C.queryResults;return c}function l(a,b){var c=a?vm.P.queryResults.filter(d.createFilterFor(a)):vm.P.queryResults;return c}function m(a,b){var c=a?vm.P.queryResults.filter(d.createFilterForDisplay(a)):vm.P.queryResults;return c}function n(){for(vm.F.prix.ttc=0,vm.F.prix.ht=0,index=0;index<vm.Produits.length;++index)vm.F.prix.ttc=vm.F.prix.ttc+vm.Produits[index].tttc,vm.F.prix.ht=vm.F.prix.ttc/1.2}vm=this,vm.Produits=[],vm.simulateQuery=!1,vm.isDisabled=!1,vm.thtp="20%",vm.F={},vm.F.client={},vm.F.prix={},vm.F.produits=[],vm.F.prix.ht=0,vm.C={},vm.C.client={},vm.C.queryResults=[],vm.C.queryResults=i()||[],vm.querySearch=k,vm.querySearchproduits=l,vm.querySearchproduitsD=m,vm.P={},vm.P.queryResults=[],vm.P.queryResults=j()||[],vm.selectedCItemChange=h(),vm.selectedItemChange=d.selectedItemChange(),vm.searchTextChange=d.searchTextChange(),vm.newState=d.newState(),vm.F.Produits=[],vm.ajouterChamp=function(){vm.Produits.push({})},vm.delChamp=function(a){vm.Produits.splice(a,1),n()},vm.cancel=function(){c.dismiss("cancel")},vm.totalFacture=function(a){if(a.selectedItem&&a.selectedItem.prix&&a.quantite)return a.tttc=a.selectedItem.prix.vente*a.quantite,a.ht=a.selectedItem.prix.vente/1.2,a.ht=a.ht.toFixed(2),n(),a},vm.ok=function(b){for(vm.FL={},vm.FL.produits=[],vm.FL.prix={},vm.FL.client={},vm.FL.date=b.date,vm.FL.vendeur="Admin",vm.FL.prix.ht=vm.F.prix.ht,vm.FL.prix.ttc=vm.F.prix.ttc,vm.FL.client=vm.C.selectedItem,vm.FL.client.id=vm.C.selectedItem.ref,vm.FL.client.nom=vm.C.selectedItem.display,index=0;index<vm.Produits.length;++index)vm.FL.produits.push({ref:vm.Produits[index].selectedItem.ref,garantie:{duree:vm.Produits[index].selectedItem.garantie.duree},denomination:vm.Produits[index].selectedItem.denomination,quantite:vm.Produits[index].quantite,prix:{ttc:vm.Produits[index].selectedItem.prix.vente,ht:vm.Produits[index].selectedItem.prix.vente/1.2,tttc:vm.Produits[index].quantite*vm.Produits[index].selectedItem.prix.vente}});g.setDevis(vm.FL).then(function(b){c.close(),a.path("/Devis/"+b._id)})},vm.newClient=function(){b.open({animation:vm.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"/cl/_modules/client/index.modal.view.client.html",controller:"ClientmodalController",controllerAs:"cCtrl"}).result.then(function(a){vm.C.queryResults=i()||[]})}}function VenteController(a,b,c,d,e,f){a.Vente=e.query({venteId:d.venteId}),a.Produits=f.query(),a.Total=null,a.supprimerVente=function(b){a.Vente=e.delete({venteId:b._id})},console.log(a.Vente),a.Vente.$promise.then(function(b){b.produits&&angular.forEach(b.produits,function(b,c){a.Total=a.Total+b.prix})})}function VenteService(a,b){return a("",{userId:"@id"},{query:{method:"GET",url:"/api/Vente/:venteId"},save:{method:"POST",url:"/api/Vente","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/Vente/:venteId"}})}function FacturationService(a){function b(b){function c(a){return a.data}function d(a){return console.log(a)}return a.delete("/api/Facture/"+b).then(c).catch(d)}function c(b){function c(a){return a.data.SUCCESS}function d(a){return console.log(a)}return a.get("/api/Facture/"+b).then(c).catch(d)}function d(){function b(a){return a.data.SUCCESS}function c(a){return console.log(a)}return a.get("/api/FactureList/Aujourdhui").then(b).catch(c)}function e(b){function c(a){return a.data.SUCCESS}function d(a){return console.log(a)}return a.post("/api/Facture",b).then(c).catch(d)}function f(){function b(a){return a.data.SUCCESS}function c(a){return console.log(a)}return a.get("/api/FactureList/Annee").then(b).catch(c)}function g(){function b(a){return a.data.SUCCESS}function c(a){return console.log(a)}return a.get("/api/FactureList/Mois").then(b).catch(c)}function h(b){function c(a){return a.data.SUCCESS}function d(a){return console.log(a)}return a.post("/api/FactureList/Jour",b).then(c).catch(d)}function i(b){function c(a){return a.data.SUCCESS}function d(a){return console.log(a)}return a.post("/api/FactureList/Jour2",b).then(c).catch(d)}function j(b){function c(a){return a.data}function d(a){return console.log(a)}return a.delete("/api/Devis/"+b).then(c).catch(d)}function k(b){function c(a){return a.data.SUCCESS}function d(a){return console.log(a)}return a.get("/api/Devis/"+b).then(c).catch(d)}function l(){function b(a){return console.log("GetDevislist:",a),a.data}function c(a){return console.log(a)}return a.get("/api/DevisList").then(b).catch(c)}function m(b){function c(a){return a.data.SUCCESS}function d(a){return console.log(a)}return a.post("/api/Devis",b).then(c).catch(d)}function n(){function b(a){return a.data.SUCCESS}function c(a){return console.log(a)}return a.get("/api/DevisList/Annee").then(b).catch(c)}function o(){function b(a){return a.data.SUCCESS}function c(a){return console.log(a)}return a.get("/api/DevisList/Mois").then(b).catch(c)}function p(b){function c(a){return a.data.SUCCESS}function d(a){return console.log(a)}return a.post("/api/DevisList/Jour",b).then(c).catch(d)}function q(b){function c(a){return a.data.SUCCESS}function d(a){return console.log(a)}return a.post("/api/DevisList/Jour2",b).then(c).catch(d)}return{getFacture:c,setFacture:e,getFactureList:d,delFacture:b,getAnneeFactureList:f,getMoisFactureList:g,getJourFactureList:h,getJourFactureList2:i,getDevis:k,setDevis:m,getDevisList:l,delDevis:j,getAnneeDevisList:n,getMoisDevisList:o,getJourDevisList:p,getJourDevisList2:q}}function SessionController(a){function b(b,c){a.setToken(b),a.setName(c),a.setIslogedIn(!0)}function c(){a.setIslogedIn(!1)}return{create:b,destroy:c}}function SessionService(){function a(a){g=a}function b(){return g}function c(a){h=a}function d(){return h}function e(a){i=a}function f(){return i}var g,h,i;return{setName:a,getName:b,setToken:c,getToken:d,setIsLogedIn:e,getIsLogedIn:f}}function TachesController(a,b,c,d,e,f,g){a.Produits=d.query(),a.Matieres=f.query(),a.fProduit=function(b){b.produit.nomenclature.produits.length>0&&angular.forEach(b.produit.nomenclature.produits,function(c,d){angular.forEach(a.Produits,function(a,d){if(c.id===a.id&&b.qtt*c.qtt>a.qtt)return console.debug("Pas de stock")})}),b.produit.nomenclature.matieres.length>0&&angular.forEach(b.produit.nomenclature.matieres,function(c,d){angular.forEach(a.Matieres,function(a,d){if(c.id===a.id&&b.qtt*c.qtt>a.qtt)return console.debug("Pas de stock")})}),b.produit.nomenclature.produits.length>0&&angular.forEach(b.produit.nomenclature.produits,function(c,d){angular.forEach(a.Produits,function(d,f){c.id===d.id&&b.qtt*c.qtt<d.qtt&&(d.qtt=d.qtt-b.qtt*c.qtt,b.produit.qtt?b.produit.qtt=b.produit.qtt+b.qtt:b.produit.qtt=b.qtt,a.Produit=e.save(b.produit,function(){}),a.Produit=e.save(d,function(){}))})}),b.produit.nomenclature.matieres.length>0&&angular.forEach(b.produit.nomenclature.matieres,function(c,d){angular.forEach(a.Matieres,function(d,f){c.id===d.id&&b.qtt*c.qtt<d.qtt&&(d.qtt=d.qtt-b.qtt*c.qtt,b.produit.qtt?b.produit.qtt=b.produit.qtt+b.qtt:b.produit.qtt=b.qtt,a.Produit=e.save(b.produit,function(){}),a.Matiere=g.save(d,function(){}))})})}}function TachesService(a){return a("",{},{})}function UsersController(a,b,c,d,e){a.Users=d.query(),a.sUser=function(b){console.log("del"),a.User=e.delete({userId:b._id},function(){a.Users=d.query(),console.log("del ok")})},a.aUser=function(b){var c=angular.toJson(b);a.User=e.save(c,function(){a.ajoutU={},a.Users=d.query()})}}function UsersService(a,b){return a("",{},{query:{method:"GET",url:"/api/Users",isArray:!0}})}function UserController(a,b,c,d,e){a.User=e.query({userId:d.userId})}function UserService(a,b){return a("",{userId:"@id"},{query:{method:"GET",url:"/api/User/:userId"},save:{method:"POST",url:"/api/User","Content-Type":"application/x-www-form-urlencoded"},delete:{method:"DELETE",url:"/api/User/:userId"}})}angular.module("GpApp",["ngSanitize","ngRoute","ngStorage","appServices","ngCookies","ngResource","appControllers","GpApp.mProducts","GpApp.mSales","GpApp.mPurchases","GpApp.mClients","GpApp.mAuth","GpApp.mEntrepot","GpApp.mEmployees","GpApp.mMachinery","GpApp.mTaches","GpApp.mConfiguration","GpApp.mUsers"]),angular.module("GpApp").config(["$routeProvider",function(a){a.when("/Users",{templateUrl:"./App/modules/user/users.view.user.html",controller:"UsersController"}).when("/User/:userId",{templateUrl:"./App/modules/user/index.view.user.html",controller:"UserController"}).otherwise({redirectTo:"/"})}]),angular.module("GpApp.mAuth",[]).factory("LoginService",LoginService).factory("AuthenticationService",AuthenticationService).controller("LoginController",LoginController).config(["$routeProvider",function(a){a.when("/Login",{templateUrl:"./App/modules/auth/login/view.html",controller:"LoginController"})}]),LoginController.$inject=["$scope","$http","$sce","$cookieStore","$location","LoginService","AuthenticationService"],LoginService.$inject=["$resource"],AuthenticationService.$inject=["$http","$localStorage"],ClientController.$inject=["$scope","$http","$routeParams","$sce","ClientService"],ClientService.$inject=["$resource","$localStorage"],ClientsController.$inject=["$scope","$http","$sce","ClientService","ClientsService"],angular.module("GpApp.mClients",[]).factory("ClientService",ClientService).factory("ClientsService",ClientsService).controller("ClientController",ClientController).controller("ClientsController",ClientsController).config(["$routeProvider",function(a){a.when("/Clients",{templateUrl:"./App/modules/clients/clients/view.html",controller:"ClientsController",controllerAs:"vm"}).when("/Client/:clientId",{templateUrl:"./App/modules/clients/client/view.html",controller:"ClientController",controllerAs:"vm"})}]),ClientsService.$inject=["$resource","$localStorage"],angular.module("GpApp.mConfiguration",[]).controller("ConfigurationController",ConfigurationController).config(["$routeProvider",function(a){a.when("/Configuration",{templateUrl:"./App/modules/configuration/view.html",controller:"ConfigurationController"})}]),
ConfigurationController.$inject=["$scope","$http","$sce"],angular.module("GpApp.mEmployees",[]).factory("EmployeService",EmployeService).factory("PersonnelService",PersonnelService).controller("PersonnelController",PersonnelController).controller("EmployeController",EmployeController).config(["$routeProvider",function(a){a.when("/Personnel",{templateUrl:"/App/modules/employees/index/view.html",controller:"PersonnelController"}).when("/Personnel/:employeId",{templateUrl:"./App/modules/employees/employe/view.html",controller:"EmployeController"})}]),PersonnelController.$inject=["$scope","$http","$sce","PersonnelService","EmployeService"],EmployeController.$inject=["$scope","$http","$routeParams","$sce","EmployeService"],PersonnelService.$inject=["$resource","$localStorage"],EmployeService.$inject=["$resource","$localStorage"],EtatsService.$inject=[],angular.module("appControllers",[]),angular.module("appServices",[]).factory("EtatsService",EtatsService),angular.module("GpApp.mMachinery",[]).factory("MachineService",MachineService).factory("MachineryService",MachineryService).factory("MouleService",MouleService).factory("MoulesService",MoulesService).controller("MachineController",MachineController).controller("MachineryController",MachineryController).controller("MouleController",MouleController).controller("MoulesController",MoulesController).config(["$routeProvider",function(a){a.when("/Machinery",{templateUrl:"./App/modules/machinery/machinery/view.html",controller:"MachineryController",controllerAs:"vm"}).when("/Machine/:machineId",{templateUrl:"./App/modules/machinery/machine/view.html",controller:"MachineController",controllerAs:"vm"}).when("/Moules",{templateUrl:"./App/modules/machinery/molds/view.html",controller:"MoulesController",controllerAs:"vm"}).when("/Moule/:mouleId",{templateUrl:"./App/modules/machinery/mold/view.html",controller:"MouleController",controllerAs:"vm"})}]),MachineryService.$inject=["$resource","$localStorage"],MachineController.$inject=["$scope","$http","$routeParams","$sce","MachineService"],MachineService.$inject=["$resource","$localStorage"],MachineryController.$inject=["$scope","$http","$sce","MachineryService","MachineService"],MouleController.$inject=["$scope","$http","$routeParams","$sce","MouleService","MachineryService"],MouleService.$inject=["$resource","$localStorage"],MoulesController.$inject=["$scope","$http","$sce","MoulesService","MouleService","MachineryService"],MoulesService.$inject=["$resource","$localStorage"],angular.module("GpApp.mEntrepot",[]).controller("EntrepotController",EntrepotController).config(["$routeProvider",function(a){a.when("/Entrepot",{templateUrl:"./App/modules/products/entrepot/view.html",controller:"EntrepotController",controllerAs:"vm"})}]),EntrepotController.$inject=["$scope","$http","$sce","MatieresService","ProduitsService"],angular.module("GpApp.mProducts",[]).factory("ProduitService",ProduitService).factory("ProduitsService",ProduitsService).factory("MatiereService",MatiereService).factory("MatieresService",MatieresService).controller("ProduitsController",ProduitsController).controller("ProduitController",ProduitController).controller("MatiereController",MatiereController).controller("MatieresController",MatieresController).config(["$routeProvider",function(a){a.when("/Products",{templateUrl:"./App/modules/products/products/view.html",controller:"ProduitsController",controllerAs:"vm"}).when("/Produit/:produitId",{templateUrl:"/App/modules/products/product/view.html",controller:"ProduitController",controllerAs:"vm"}).when("/Matieres",{templateUrl:"./App/modules/products/materials/view.html",controller:"MatieresController",controllerAs:"vm"}).when("/Matiere/:matiereId",{templateUrl:"./App/modules/products/material/view.html",controller:"MatiereController",controllerAs:"vm"})}]),ProduitsService.$inject=["$resource","$localStorage"],MatiereController.$inject=["$scope","$http","$routeParams","MatiereService","FournisseursService"],MatiereService.$inject=["$resource","$localStorage"],MatieresController.$inject=["$scope","$http","$sce","MatieresService","MatiereService","FournisseursService"],MatieresService.$inject=["$resource","$localStorage"],ProduitController.$inject=["$scope","$http","$routeParams","ProduitService","ProduitsService","MatieresService"],ProduitService.$inject=["$resource","$localStorage"],ProduitsController.$inject=["$scope","$http","$sce","ProduitsService","ProduitService","MatieresService"],angular.module("GpApp.mPurchases",[]).factory("AchatService",AchatService).factory("AchatsService",AchatsService).factory("FournisseurService",FournisseurService).factory("FournisseursService",FournisseursService).controller("AchatController",AchatController).controller("AchatsController",AchatsController).controller("FournisseurController",FournisseurController).controller("FournisseursController",FournisseursController).config(["$routeProvider",function(a){a.when("/Achats",{templateUrl:"./App/modules/purchases/purchases/view.html",controller:"AchatsController",controllerAs:"vm"}).when("/Achat/:achatId",{templateUrl:"./App/modules/purchases/purchase/view.html",controller:"AchatController",controllerAs:"vm"}).when("/Fournisseurs",{templateUrl:"./App/modules/purchases/providers/view.html",controller:"FournisseursController",controllerAs:"vm"}).when("/Fournisseur/:fournisseurId",{templateUrl:"./App/modules/purchases/provider/view.html",controller:"FournisseurController",controllerAs:"vm"})}]),AchatsService.$inject=["$resource","$localStorage"],FournisseurController.$inject=["$scope","$http","$routeParams","$sce","FournisseurService"],FournisseurService.$inject=["$resource","$localStorage"],FournisseursController.$inject=["$scope","$http","$sce","FournisseursService","FournisseurService"],FournisseursService.$inject=["$resource","$localStorage"],AchatController.$inject=["$scope","$http","$sce","$routeParams","AchatServices"],AchatService.$inject=["$resource","$localStorage"],AchatsController.$inject=["$scope","$http","$sce","AchatsService","AchatService","FournisseursService","ProduitsService","MatieresService","EtatsService"],FactureController.$inject=["$routeParams","FacturationService"],FacturemodalController.$inject=["$location","$uibModal","$uibModalInstance","autocservice","clientservice","produitservice","FacturationService"],FacturationController.$inject=["$location","$uibModal","FacturationService"],angular.module("GpApp.mSales",[]).factory("VenteService",VenteService).factory("VentesService",VentesService).controller("VenteController",VenteController).controller("VentesController",VentesController).config(["$routeProvider",function(a){a.when("/Vente/:venteId",{templateUrl:"./App/modules/sales/sale/view.html",controller:"VenteController"}).when("/Ventes",{templateUrl:"./App/modules/sales/index/view.html",controller:"VentesController"})}]),VentesController.$inject=["$scope","$http","$sce","VenteService","VentesService","ClientsService","ProduitsService"],VentesService.$inject=["$resource","$localStorage"],DevisController.$inject=["$routeParams","FacturationService"],DevismodalController.$inject=["$location","$uibModal","$uibModalInstance","autocservice","clientservice","produitservice","FacturationService"],VenteController.$inject=["$scope","$http","$sce","$routeParams","VenteService","ProduitsService"],VenteService.$inject=["$resource","$localStorage"],FacturationService.$inject=["$http"],SessionController.$inject=["SessionService"],SessionService.$inject=[],angular.module("GpApp.mTaches",[]).controller("TachesController",TachesController).config(["$routeProvider",function(a){a.when("/Taches",{templateUrl:"./App/modules/tache/index/view.html",controller:"TachesController"})}]),TachesController.$inject=["$scope","$http","$sce","ProduitsService","ProduitService","MatieresService","MatiereService"],TachesService.$inject=["$resource"],angular.module("GpApp.mUsers",[]).factory("UserService",UserService).factory("UsersService",UsersService).controller("UserController",UserController).controller("UsersController",UsersController).config(["$routeProvider",function(a){a.when("/Users",{templateUrl:"./App/modules/users/index/view.html",controller:"UsersController"}).when("/User/:userId",{templateUrl:"./App/modules/users/user/view.html",controller:"UserController"})}]),UsersController.$inject=["$scope","$http","$sce","UsersService","UserService"],UsersService.$inject=["$resource","$localStorage"],UserController.$inject=["$scope","$http","$sce","$routeParams","UserService"],UserService.$inject=["$resource","$localStorage"];